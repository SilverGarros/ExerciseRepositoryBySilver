# 此题有大坑！！

## **此题有大坑！！想要检测通过，需要使用经过处理后的image替换原来的图像！！！**

## 且必须一次完成`解压`、`运行代码`、`提交检测`方能通过

首先在环境命令行内输入`unzip -q -o /home/project/Imagedata.zip -d ./` 解压文件夹。

代码如下：

``` python
def img_processor(data_path, dst_size = (224,224)):
    Image_std = [0.229, 0.224, 0.225]
    Image_mean = [0.485, 0.456, 0.406]
    _std = np.array(Image_std).reshape((1,1,3))
    _mean = np.array(Image_mean).reshape((1,1,3))
    image_src = cv2.imread(data_path)
    #TODO
    # 调整当前image_src的尺寸
    image = cv2.resize(image_src,(256,256))
    
    # 计算图像调整的初始像素及结束像素值，注意opencv的像素点位置坐标为先行后列(y,x)且初始为0
    startx = (image.shape[1] - dst_size[1])//2 # (256-224)//2 = 16
    starty = (image.shape[0] - dst_size[0])//2 
    endx = startx + dst_size[1] # 16 + 224 = 240
    endy = starty + dst_size[0]

    # 使用索引提取的方式完成图像截取[16,16:240,240]
    image = image_src[starty:endy,startx:endx]

    # 进行标准化

    image = (image - _mean)/ _std

    # ！！！一定要用处理后的image保存替换原图像，可能绝大多数未能通过都在这一步，编题人就不能说清楚要求吗，
    # 提交了50+次不通过 T_T
    cv2.imwrite(data_path,image)

    return image_src, image, (startx,starty)
```

