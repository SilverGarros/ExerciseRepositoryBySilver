## 无监督算法应用

#### 介绍

在新媒体平台上，根据用户的兴趣、行为或偏好，自动将用户分类到不同的兴趣类别可以实现个性化推荐或定向广告投放。为了提升现有模型的效果，使用无监督算法来提升分类模型的方法是一种常见的机器学习策略。无监督算法有助于发现数据集中的潜在结构、模式和关联性，从而提供额外的信息来增强分类任务的性能。在本任务中，你需要在给定的用户数据上，尝试将无监督算法应用于训练分类模型。

#### 准备

开始答题前，请确认 `/home/project` 目录下包含以下文件：

- user_train.csv
- user_test.csv
- task.py

其中：

- `user_train.csv`，是用于训练的用户数据集，共 55 列，其中前 54 列是数值型特征，最后 1 列是类别标签（取值范围是 1～7）。
- `user_test.csv`，是用于测试的用户数据集，共 55 列，其中前 54 列是数值型特征，最后 1 列是类别标签（取值范围是 1～7）。
- `task.py`，是你后续答题过程中编写代码的地方。

#### 目标

请在 `task.py` 文件中根据以下要求编写函数代码。

**`classification_with_clustering`** 函数

- 函数功能
  - 使用 K-means 算法对特征数据进行聚类，并将聚类标签作为额外特征与原特征数据合并。
  - 在合并后的特征数据上训练一个随机森林分类器，即模型 B，并在测试集上进行预测。
- 参数
  - X_train（pandas.DataFrame）：训练集的特征数据。
  - X_test（pandas.DataFrame）：测试集的特征数据。
  - y_train（pandas.Series）：训练集的目标变量。
  - y_test（pandas.Series）：测试集的目标变量。
- 返回值
  - accuracy（float），即在测试集上的预测准确率，同 `classification_without_clustering` 函数中的模型评估方法。

基于以下代码补充 `#TODO` 处的函数代码，并执行 `main()` 函数，确保能够实现以下目标：

- 正确实现模型 B 的训练和预测，且在测试集上的准确率相对未使用聚类方法时（即调用` classification_without_clustering` 函数训练的模型效果）至少提升 1%。

> 提示：点击代码块右上方的 `copy` 按钮，将代码完整复制到右侧环境中后开始编码。

```python
import pandas as pd
from sklearn.cluster import KMeans
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score
import warnings
warnings.filterwarnings('ignore')

def classification_without_clustering(rf_classifier, X_train, X_test, y_train, y_test):
    # 训练随机森林分类器
    rf_classifier.fit(X_train, y_train)
    # 在测试集上进行预测
    y_pred = rf_classifier.predict(X_test)
    # 计算分类准确率
    accuracy = accuracy_score(y_test, y_pred)
    return accuracy

def classification_with_clustering(rf_classifier, X_train, X_test, y_train, y_test):
    #TODO


    return accuracy


def main():
    # 读取训练集和测试集
    train_data = pd.read_csv('user_train.csv')
    test_data = pd.read_csv('user_test.csv')
    
    # 分割特征和目标变量
    X_train = train_data.drop('Label', axis=1)
    y_train = train_data['Label']
    X_test = test_data.drop('Label', axis=1)
    y_test = test_data['Label']
    
    # 创建一个随机森林分类器对象
    rf_classifier = RandomForestClassifier(random_state=20)
    accuracy1 = classification_without_clustering(rf_classifier, X_train, X_test, y_train, y_test)
    accuracy2 = classification_with_clustering(rf_classifier, X_train, X_test, y_train, y_test)
    print("聚类前分类准确率：", accuracy1)
    print("聚类后分类准确率：", accuracy2)

if __name__ == '__main__':
    main()
```

#### 规定

- 务必在 `#TODO` 所在的函数范围内编写代码，以免造成判题不通过。
- 切勿删除以上代码块中的任何字符，以免造成判题不通过。
- 切勿修改任务中默认提供的文件名称、函数名称、数据集等，以免造成判题不通过。

#### 判分标准

- 实现目标，得 15 分；
- 未实现目标，得 0 分。